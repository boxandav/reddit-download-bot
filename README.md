# Reddit Download bot

This is a bot script that downloads posts (text, media, galleries) from a list of subreddits and saves them into a directory. It runs only once as it is designed for running in a cronjob.

## Features

This script is still in development, I am planning to add more useful features in the future. For now the features are these:

- Downloads various kinds of posts (selftext, images, videos, galleries)
- Saves downloaded posts into a directory
	- Selftext posts are saved in **Markdown** format, whereas all media posts are saved in their respective format (gif, png...)
- Keeps a history of all downloaded files
- Keeps a history of errors and the ID of the posts the errors occurred in

### Planned features

- Backup script for copying and moving into another location

## How to run

In order to run this project, the libraries `praw` and `requests` are required. I recommend using `pipenv` to run it as it handles all the necessary dependencies and isolates the environment from any possible already installed libraries on the computer. The `pipenv` environment can be created using the `pipenv install` command.

### Config

A key part of this project is the **config file** which you need to create manually. The file is in **JSON** format and should look like this:

```json
{
	"bot_name": "download_bot",
	"subreddits": [],
	"save_posts": {
		"self": true,
		"media": true,
		"gallery": true
	},
	"locations": {
		"subreddits_dir": "subreddits",
		"errors": "errors.csv"
	}
}
```

In this file you can specify the list of subreddits to scan, as well as the kinds of posts you want to save and the locations you want the output to be saved in.

Copy the contents, choose the configuration as you wish and save it in the root directory as `config.json`.

### Praw initialization file

Another required file is the initialization file for `praw`, which is the Reddit API wrapper. The contents of the file are:

```ini
[DEFAULT]
# A boolean to indicate whether or not to check for package updates.
check_for_updates=True

# Object to kind mappings
comment_kind=t1
message_kind=t4
redditor_kind=t2
submission_kind=t3
subreddit_kind=t5
trophy_kind=t6

# The URL prefix for OAuth-related requests.
oauth_url=https://oauth.reddit.com

# The amount of seconds of ratelimit to sleep for upon encountering a specific type of 429 error.
ratelimit_seconds=5

# The URL prefix for regular requests.
reddit_url=https://www.reddit.com

# The URL prefix for short URLs.
short_url=https://redd.it

# The timeout for requests to Reddit in number of seconds
timeout=16
```

I recommend leaving this part as is. Below that in the same file you can add a configuration for the bot. However, first you need to **register** your Reddit app in **Reddit Apps**  in order to obtain the token and secret value which you will insert in the bot configuration:

```ini
[BOT_NAME]
client_id=
client_secret=
password=
username=
user_agent=
```

Replace `BOT_NAME` with the value you set in `bot_name` in `config.json`. Then fill in all the required values (client ID, client secret, password and username) which should be generated by **Reddit Apps**. You can put virtually any value as `user_agent`.

For more information on how to initialize a Reddit app, you can read the `praw` documentation [here](https://praw.readthedocs.io/en/stable/getting_started/configuration/prawini.html).

### Running

You can run the bot with the command below:

```
python -m script
```

If you are using `pipenv`, first write `pipenv run` before the call.

### Output location

All posts are saved in the directory set in `subreddits_dir` inside the `locations` configuration. Each subreddit has its own directory with its posts, as well as the download history which is stored in `posts_{subreddit}.csv`.

In case the script runs into any errors, you can see them in `errors.csv` in the root directory.